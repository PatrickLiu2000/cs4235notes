# Malicious Code (Malware)
- 2 categories
    - needs host
        - trojan horses, viruses, browser plugins, etc
    - independent
        - botnets, worms, etc
## Trap Doors
- secret entry point into program/system
    - works by recognizing special sequence of inputs/user ID
## Logic Bombs
- embedded in legit program
- "explode"/perform malicious activities when conditions are met

## Trojan Horses
- hidden in seemingly useful host program
- performs harmful function when host program is executed

## Viruses
- infects program by modifying it
- self-copies in program to spread
- 4 stages
    - dormant phase
    - propogation phase
    - triggering phase
    - execution phase
### Virus Structure
- 1st line - go to main program
- 2nd line - a flag (infected/not infected)
- main
    - find uninfected programs to infect
    - do something damaging to the system
    - go to first line of host program to do "regular work"
- avoids detection by looking at the size of the program
    - compress/decompress host program
### Type of Viruses
- parasitic virus - scan/infect programs
- memory-resident virus - infects running programs
- macro virus - embedded in documents, spread when opened
- boot sector virus - run/spread whenever system is booted
- polymorphic virus - encrypt part of virus program using randomly generated key

## Rootkit
- resides in OSs
    - modifies OS and data structure
- helps user-level malware  
    - hides the malware from the user
## Worms
- use network connections to spread from system to system
### Example: The Internet Worm
- determined where it could spread - spread infection
    - caused resource exhaustion
    - servers had to be disconnected from internet to stop infection
    - exploited security flaws
    - remained undiscoverable initially
        - loaded code into memory, encrypted, then removed file
        - periodically changed name and process ID
## Malware Prevention/Detection
- 